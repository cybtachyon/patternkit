services:
  logger.channel.patternkit:
    parent: logger.channel_base
    arguments: ['patternkit']
  path_processor.patterns:
    class: Drupal\patternkit\PathProcessor\PathProcessorPatterns
    tags:
      - { name: path_processor_inbound, priority: 200 }
  patternkit.library.discovery:
    class: Drupal\patternkit\PatternkitLibraryDiscovery
    arguments: ['@patternkit.library.discovery.collector']
  patternkit.library.discovery.collector:
    class: Drupal\patternkit\PatternLibraryCollector
    arguments: ['@cache.discovery', '@config.factory', '@file_system', '@plugin.manager.library.pattern', '@lock', '@logger.channel.default', '@module_handler', '@app.root', '@theme.manager']
    tags:
      - { name: needs_destruction }
  patternkit.library.discovery.parser.file:
    class: Drupal\patternkit\PatternLibraryParser\FilePatternLibraryParser
    arguments: ['@serialization.json', '@app.root', '@module_handler', '@theme.manager']
  patternkit.library.discovery.parser.json:
    class: Drupal\patternkit\PatternLibraryParser\JSONPatternLibraryParser
    arguments: ['@serialization.json', '@app.root', '@module_handler', '@theme.manager']
  patternkit.library.discovery.parser.twig:
    class: Drupal\patternkit\PatternLibraryParser\TwigPatternLibraryParser
    arguments: ['@serialization.json', '@app.root', '@module_handler', '@theme.manager']
  patternkit.opener.jsonlibrary:
    class: Drupal\patternkit\MediaLibraryJSONLibraryOpener
    arguments: ['@entity_type.manager']
  plugin.manager.library.pattern:
    class: Drupal\patternkit\PatternLibraryPluginManager
    arguments: ['@container.namespaces', '@cache.discovery', '@module_handler', '@theme_handler']
  stream_wrapper.library:
    class: Drupal\patternkit\StreamWrapper\LibraryStream
    tags:
      - { name: stream_wrapper, scheme: library }
  stream_wrapper.patternkit:
    class: Drupal\patternkit\StreamWrapper\PatternkitStream
    tags:
      - { name: stream_wrapper, scheme: patternkit }
  twig.loader.patternlibrary:
    class: Drupal\patternkit\Loader\PatternLibraryLoader
    # We use '.' instead of '@app.root' as the path for non-namespaced template
    # files so that they match the relative paths of templates loaded via the
    # theme registry or via Twig namespaces.
    arguments: ['.', '@logger.channel.patternkit', '@patternkit.library.discovery.collector']
    tags:
      - { name: twig.loader, priority: 100 }
